
<div [@slideIn] class="h-full flex flex-col">
  <div class="flex items-center justify-between p-4 border-b border-gray-100">
    <h3 class="font-medium">Chat History</h3>
    <button 
      (click)="closeHistory.emit()" 
      class="p-1 rounded-full hover:bg-gray-200 transition-colors"
      aria-label="Close history">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    </button>
  </div>
  
  <button
    (click)="createNewChat()"
    class="m-3 py-2 px-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors flex items-center justify-center gap-2"
  >
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <line x1="12" y1="5" x2="12" y2="19"></line>
      <line x1="5" y1="12" x2="19" y2="12"></line>
    </svg>
    New Chat
  </button>
  
  <div class="flex-1 overflow-y-auto">
    <div *ngIf="(sessions$ | async)?.length === 0" class="p-4 text-center text-gray-500">
      No chat history yet.
    </div>
    
    <ng-container *ngIf="(sessions$ | async) as sessions">
      <div *ngFor="let session of sessions; let i = index" 
           [@itemAnimation]="{ value: '', params: { delay: i * 0.05 } }"
           class="px-3 py-2 hover:bg-gray-100 cursor-pointer transition-colors"
           [ngClass]="{'bg-gray-100': (currentSession$ | async)?.id === session.id}"
           (click)="selectChat(session)">
        <div class="flex items-start justify-between">
          <h4 class="text-sm font-medium truncate w-40">{{session.title}}</h4>
          <span class="text-xs text-gray-500">{{formatDate(session.updatedAt)}}</span>
        </div>
        <p *ngIf="session.messages.length > 0" class="text-xs text-gray-500 truncate">
          {{session.messages[session.messages.length - 1].message}}
        </p>
      </div>
    </ng-container>
  </div>
</div>
